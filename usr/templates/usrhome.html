{% extends 'head_base.html' %}
{% block style %}
<!DOCTYPE html>
<html lang="zh-CN">

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      background-color: #f7f7f7;
    }



    .container {
      display: flex;
      min-height: calc(100vh - 60px);
    }

    .sidebar {
      width: 220px;
      background-color: #fff;
      border-right: 1px solid #ddd;
    }

    .menu {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .menu li {
      padding: 15px 20px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      display: flex;
      align-items: center;
      transition: transform 0.2s ease, background-color 0.3s ease;
    }

    .menu li:hover {
      background-color: dimgrey;
      transform: scale(1);  /* Zoom-in effect */
    }

    .menu li.active {
      background-color: #ff5000;  /* 选中时高亮为橙色 */
      color: white;  /* 字体颜色为白色 */
    }

    .menu i {
      margin-right: 10px;
      color: #ff5000;
    }

    .content {
      flex: 1;
      padding: 30px;
      background-color: #f5f5f5;
    }

    .section {
      background: white;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }

    .section h3 {
      margin-top: 0;
    }

    .order-item, .favorite-item, .address-item {
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
      }

      .content {
        padding: 15px;
      }
    }
      a:hover {
        transform: scale(1.2);  /* 放大效果 */
      }
      img:hover {
        transform: scale(1.2);  /* 放大效果 */
      }
      .zoom-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
      }

      .zoom-card:hover {
          transform: scale(1.03);
          box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }
  </style>

{% endblock %}
{% block content %}
<body>


  <div class="container">
    <div class="sidebar">
      <ul class="menu">
        <!-- 改成这样 -->
        <li onclick="showSection('orders'); setActive(this)">
          <i class="iconfont icon-dingdan"></i> 我的金币
        </li>
        <li onclick="showSection('addresses'); setActive(this)">
          <i class="iconfont icon-dizhi"></i> 地址管理
        </li>
        <li onclick="showSection('account'); setActive(this)">
          <i class="iconfont icon-zhanghuzhongxin"></i> 账户中心
        </li>
        <li onclick="showSection('store_section'); setActive(this)">
          <i class="iconfont icon-wodedianpu"></i> 我的店铺
        </li>

      </ul>
    </div>

    <div class="content">
      <div id="orders" class="section">
          <h3>我的金币</h3>
          <p>当前金币余额：<strong>{{ request.user.gold_coins }}</strong></p>
          <button onclick="showRechargeModal()">充值金币</button>
        </div>

        <!-- 模态框 -->
        <div id="rechargeModal" style="display:none; position:fixed; top:20%; left:30%; background:#fff; padding:20px; border:1px solid #ccc;">
          <h4>扫码充值</h4>
          <img src="{% static 'img/pay.jpg' %}" alt="收款二维码" style="max-width:200px;">
          <form method="post" action="{% url 'usr:submit_recharge' %}">
            {% csrf_token %}
            <label>充值金额：</label>
            <input type="number" name="amount" required min="1">
            <button type="submit">提交充值记录</button>
          </form>
          <button onclick="document.getElementById('rechargeModal').style.display='none'">关闭</button>
      </div>

      <script>
          function showRechargeModal() {
            document.getElementById('rechargeModal').style.display = 'block';
          }
      </script>


      <div id="favorites" class="section" style="display:none;">
        <h3>我的收藏</h3>
        <div class="favorite-item">商品 A - ￥99.00</div>
        <div class="favorite-item">商品 B - ￥45.00</div>
      </div>

        <div id="addresses" class="section" style="display:none;">
          <h3>地址管理</h3>
          <div class="address-item" id="current-address">{{ request.user.address }}</div>
          <button onclick="showAddressModal()">修改地址</button>
        </div>

        <!-- 修改地址的模态框 -->
        <div id="addressModal" style="display:none; position:fixed; top:20%; left:30%; background:#fff; padding:20px; border:1px solid #ccc; z-index:1000;">
          <h4>修改地址</h4>
          <form method="post" action="{% url 'usr:update_address' %}">
            {% csrf_token %}
            <label for="new_address">新地址：</label>
            <input type="text" id="new_address" name="new_address" required style="width: 300px;">
            <br><br>
            <button type="submit">提交</button>
            <button type="button" onclick="closeAddressModal()">取消</button>
          </form>
        </div>

        <script>
          function showAddressModal() {
            document.getElementById('addressModal').style.display = 'block';
          }

          function closeAddressModal() {
            document.getElementById('addressModal').style.display = 'none';
          }
        </script>

        <div id="account" class="section" style="display:none;">
          <h3>账户信息</h3>
          <p>用户名：{{ request.user.username }}</p>
          <p>绑定手机号：{{ request.user.phone|default:"未绑定" }}</p>
          <p>邮箱：{{ request.user.email|default:"未设置" }}</p>
        </div>
        {% if store %}
          <a href="{% url 'store:store_detail' store.id %}" style="text-decoration: none; color: inherit;">
            <div id="store_info_section" class="section zoom-card" style="display:none;">
              {% if store.avatar %}
                <img src="{{ store.avatar.url }}" alt="商店头像" style="width: 200px; border-radius: 4px;">
              {% else %}
                <p>暂无商店头像</p>
              {% endif %}
              <p><strong>商店名称：</strong>{{ store.name }}</p>
              <p><strong>商店简介：</strong>{{ store.description }}</p>
            </div>
          </a>
        {% endif %}

        <!-- 始终显示新建商店按钮 -->
        <div id="store_create_section" class="section" style="display:none; margin-top: 20px;">
          <h3>创建新的商店</h3>
          <p>点击下方按钮开设你的专属商店：</p>
          <a href="{% url 'store:store_enroll' %}">
            <button style="padding: 8px 16px; background-color: #ff5000; color: white; border: none; border-radius: 4px; cursor: pointer;">创建商店</button>
          </a>
        </div>







    </div>
  </div>

  <script>
    function showSection(id) {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');

      if (id === 'store_section') {
        const info = document.getElementById('store_info_section');
        const create = document.getElementById('store_create_section');
        if (info) info.style.display = 'block';
        if (create) create.style.display = 'block';  // 仅在点击“我的店铺”时显示
      } else {
        const section = document.getElementById(id);
        if (section) section.style.display = 'block';
      }
    }


    function setActive(clickedElement) {
      // 移除所有列表项的 active 类
      document.querySelectorAll('.menu li').forEach(el => el.classList.remove('active'));
      // 为点击的列表项添加 active 类
      clickedElement.classList.add('active');
    }
  </script>
</body>
</html>
{% endblock %}
